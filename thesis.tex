\documentclass{report}

\usepackage{geometry}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{siunitx}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage[all]{hypcap} % ref link aligned to float top (KEEP AFTER HYPERREF!)
\usepackage[font={sf}]{caption} % sans font in captions
\usepackage{fancyhdr}
\usepackage[style=alphabetic]{biblatex}
\usepackage{booktabs} % \*rule commands for tabular
\usepackage{lineno} % \linenumbers
\usepackage{etoolbox} % \ifnumcomp

\geometry{%
    a4paper,
    asymmetric, % twoside, but marginpar are always to the right
    centering,
    textwidth=345pt, % default LaTeX textwidth with 10pt
    top=1.8cm,
    bottom=1.8cm,
    marginparwidth=3.5cm,
    headsep=0cm,
    footskip=0cm,
    % showframe,
}

\linenumbers % print line numbers (for the draft)

\addbibresource{thesis.bib}

\graphicspath{{figures/}}

\sisetup{%
    detect-all, % for units, use the font of the text where they appear
    table-number-alignment=center, % the S columns of tabular are center-aligned
}

% small sans font for marginpar
\let\oldmarginpar\marginpar
\renewcommand\marginpar[1]{\oldmarginpar{\sffamily\scriptsize #1}}

% url prefix for file preview
\newcommand\repofileurl{https://github.com/Gattocrucco/sipmfilter/blob/master}

% scriptlink command. usage: \scriptlink{filename}
\newcommand\scriptlink[1]{\texttt{(\href{\repofileurl/figthesis/#1}{#1})}}

% scriptcaption command
% usage: \scriptcaption{label prefix}{script prefix}{label}{caption}
% the command will define the label and append a link to the python script
% on github
\newcommand\scriptcaption[4]{
    \caption{
        \label{#1:#3} #4
        \scriptlink{#2#3.py}
    }
}
\newcommand\figcaption[2]{\scriptcaption{fig}{fig}{#1}{#2}}
\newcommand\tabcaption[2]{\scriptcaption{tab}{fig}{#1}{#2}}

\author{Giacomo Petrillo\\University of Pisa}

\title{Thesis draft:\\Online processing of the large area SiPM detector signals
for the DarkSide20k experiment}

\begin{document}
    
    \pagestyle{fancyplain}
    \fancyhf{}
    
    \renewcommand\headrulewidth{0pt}
    
    \newcommand\pagenumbermargin{2.7cm}
    \fancyfoot[LO]{~\hspace{\textwidth}\makebox[\pagenumbermargin][r]\thepage}
    \fancyfoot[LE]{~\hspace{-\pagenumbermargin}\makebox[\pagenumbermargin][l]\thepage}
    
    \newcommand\chaptermarkwidth{3cm}
    \newcommand\chaptermarker{\ifnumcomp{\value{chapter}}{>}{0}{CHAPTER~\thechapter}{}}
    \fancyhead[LO]{\fancyplain{}{~\hspace{\textwidth}\makebox[\chaptermarkwidth][r]{\chaptermarker}}}
    \fancyhead[LE]{\fancyplain{}{~\hspace{-\chaptermarkwidth}\makebox[\chaptermarkwidth][l]{\chaptermarker}}}
    
    \maketitle
        
    \tableofcontents
        
    \include{intro}
    \include{darkmat}
    \include{darkside}
    \include{data}
    \include{snr}
    \include{timeres}
    \include{rate}
    \include{anal}
    \include{end}
    
    \printbibliography
    
\end{document}
