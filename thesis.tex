\documentclass[11pt]{report}

\usepackage{geometry}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{siunitx}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage[all]{hypcap} % ref link aligned to float top (KEEP AFTER HYPERREF!)
\usepackage[font={sf,small}]{caption} % smaller sans font in captions
\usepackage{fancyhdr}
\usepackage[style=alphabetic]{biblatex}
\usepackage{booktabs} % \*rule commands for tabular
\usepackage{lineno} % \linenumbers
\usepackage{etoolbox} % \ifnumcomp

\newlength\bindingoffset
\setlength\bindingoffset{1cm}
\geometry{%
    a4paper,
    asymmetric, % twoside, but marginpar are always to the right
    centering,
    textwidth=360pt, % default LaTeX textwidth with 11pt (345pt for 10pt)
    top=1.8cm,
    bottom=1.8cm,
    marginparwidth=3.4cm,
    headsep=10pt,
    footskip=17pt,
    bindingoffset=\bindingoffset,
    % showframe,
}
\addtolength\marginparwidth{-0.5\bindingoffset}

\linenumbers % print line numbers (for the draft)

\addbibresource{thesis.bib}

\graphicspath{{figures/}}

\sisetup{%
    detect-all, % for units, use the font of the text where they appear
    table-number-alignment=center, % the S columns of tabular are center-aligned
}

% small sans font for marginpar
\let\oldmarginpar\marginpar
\renewcommand\marginpar[1]{\oldmarginpar{\sffamily\scriptsize #1}}

% url prefix for file preview
\newcommand\repofileurl{https://github.com/Gattocrucco/sipmfilter/blob/master}

% scriptlink command. usage: \scriptlink{filename}
\newcommand\scriptlink[1]{\texttt{(\href{\repofileurl/figthesis/#1}{#1})}}

% scriptcaption command
% usage: \scriptcaption{label prefix}{script prefix}{label}{caption}
% the command will define the label and append a link to the python script
% on github
\newcommand\scriptcaption[4]{
    \caption{
        \label{#1:#3} #4
        \scriptlink{#2#3.py}
    }
}
\newcommand\figcaption[2]{\scriptcaption{fig}{fig}{#1}{#2}}
\newcommand\tabcaption[2]{\scriptcaption{tab}{fig}{#1}{#2}}

\author{Giacomo Petrillo\\University of Pisa}

\title{Thesis draft:\\Online processing of the large area SiPM detector signals
for the DarkSide20k experiment}

\newlength\pagenumbermargin
\setlength\pagenumbermargin{2.9cm}
\addtolength\pagenumbermargin{-0.5\bindingoffset}

\newcommand\sharedstyle{%
    \renewcommand\headrulewidth{0pt}
    \fancyhf{}
    \fancyhfoffset\pagenumbermargin
    \fancyfoot[RO,LE]\thepage
}

\fancypagestyle{plain}\sharedstyle
\pagestyle{fancy}
\sharedstyle
\fancyhead[RO,LE]{\ifnumcomp{\value{chapter}}{>}{0}{CHAPTER~\thechapter}}

\begin{document}
    
    \maketitle
        
    \tableofcontents
        
    \include{intro}
    \include{darkmat}
    \include{darkside}
    \include{data}
    \include{snr}
    \include{timeres}
    \include{rate}
    \include{anal}
    \include{end}
    
    \printbibliography
    
\end{document}
